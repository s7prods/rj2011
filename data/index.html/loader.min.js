(function(){function load_next_script(){for(;;){let pFirst=loaderData.scripts[currentScriptLoadProgress++];if(!pFirst)break;if(pFirst.condition)try{if(!eval(pFirst.condition))continue}catch(b){console.warn("Error: error in condition",pFirst.condition,":",b);continue}let el=document.createElement("script");if(el.src=pFirst.url,el.required=pFirst.required,el.onload=pFirst.async?loadedEvent_async:loadedEvent_syncscript,el.onerror=pFirst.async?failedEvent_async:failedEvent_syncscript,(document.head||document.documentElement).append(el),!pFirst.async)break}}function loadedEvent_syncscript(a){reportProgress(`[${datestr()}] 已加载资源 ${a.target.src||a.target.href||""}`),load_next_script()}function loadedEvent_async(a){reportProgress(`[${datestr()}] 已加载资源 ${a.target.src||a.target.href||""}`)}function failedEvent_syncscript(a){reportProgress(divFromText(`<span style="color: red">[${datestr()}]${a.target.required?" [ERROR]":""} 资源加载失败: ${a.target.src||""}</span>`)),a.target.required||load_next_script()}function failedEvent_async(a){reportProgress(divFromText(`<span style="color: red">[${datestr()}] 资源加载失败: ${a.target.src||a.target.href||""}</span>`))}function datestr(a=new Date){return`${a.getFullYear()}-`+`${a.getMonth()+1}-${a.getDate()} `+`${a.getHours()}:${a.getMinutes()}:`+`${a.getSeconds()}.${a.getMilliseconds()}`}function reportProgress(a=""){if(HTMLElement.prototype.isPrototypeOf(a))return details.prepend(a),a;let b=document.createElement("div");return b.append(document.createTextNode(a)),details.prepend(b),b}function divFromText(a=""){let b=document.createElement("div");return b.innerHTML=a,b}let details=document.getElementById("loading_details");reportProgress("Loading...");let loaderData=null,currentScriptLoadProgress=0;fetch("data/index.html/loader.json").then(a=>a.json()).then(function(a){if(loaderData=a,a.styles)for(let b of a.styles){let a=document.createElement("link");a.rel="stylesheet",a.href=b.url,a.onload=loadedEvent_async,a.onerror=failedEvent_async,(document.head||document.documentElement).append(a)}a.scripts&&load_next_script()}).catch(a=>{reportProgress(divFromText(`<div style="color: red; font-weight: bold;">数据加载失败</div><details><summary>详细信息</summary><div>${a+""}</div></details>`))})})();